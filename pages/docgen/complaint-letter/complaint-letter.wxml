<view class="page-container">
  <!-- 头部区域 -->
  <view class="header-section">
    <navigator url="../docgen-list/docgen-list" class="back-button-wrapper">
      <view class="back-button">
        <text class="back-icon">←</text>
        <text class="back-text">返回</text>
      </view>
    </navigator>
    <view class="title-area">
      <text class="page-title">{{title}}</text>
      <view class="help-hint">
        <view class="hint-text">
          <text>💡 温馨提示</text>
          <text>
劳动监察投诉书是向劳动保障监察部门举报用人单位违反劳动法律法规行为的重要文书。请根据实际情况选择适用的投诉事项，并填写相关信息。

出于用户信息安全和平台审查机制考虑，个人敏感信息已设置为默认信息（马大帅），用户可在生成文书后复制内容并自行修改填写真实信息。
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- 表单区域 -->
  <view class="form-container">
    
    <!-- 投诉人信息卡片 -->
    <view class="form-card">
      <view class="card-header">
        <text class="card-icon">👤</text>
        <text class="card-title">投诉人信息</text>
      </view>
      
      <view class="input-group">
        <text class="input-label">姓名</text>
        <view class="form-input readonly-field">
          <text>{{formData.complainantName}}</text>
        </view>
      </view>
      
      <view class="input-group">
        <text class="input-label">身份证号码</text>
        <view class="form-input readonly-field">
          <text>{{formData.complainantIdCard}}</text>
        </view>
      </view>
      
      <view class="input-group">
        <text class="input-label">工作单位</text>
        <view class="form-input readonly-field">
          <text>{{formData.complainantWorkUnit}}</text>
        </view>
      </view>
      
      <view class="input-group">
        <text class="input-label">住址</text>
        <view class="form-textarea readonly-field">
          <text>{{formData.complainantAddress}}</text>
        </view>
      </view>
      
      <view class="input-group">
        <text class="input-label">联系方式</text>
        <view class="form-input readonly-field">
          <text>{{formData.complainantPhone}}</text>
        </view>
      </view>
    </view>

    <!-- 被投诉单位信息卡片 -->
    <view class="form-card">
      <view class="card-header">
        <text class="card-icon">🏢</text>
        <text class="card-title">被投诉单位信息</text>
      </view>
      
      <view class="input-group">
        <text class="input-label">单位名称</text>
        <view class="form-input readonly-field">
          <text>{{formData.respondentName}}</text>
        </view>
      </view>
      
      <view class="input-group">
        <text class="input-label">统一社会信用代码</text>
        <view class="form-input readonly-field">
          <text>{{formData.respondentCreditCode}}</text>
        </view>
      </view>
      
      <view class="input-group">
        <text class="input-label">住址</text>
        <view class="form-textarea readonly-field">
          <text>{{formData.respondentAddress}}</text>
        </view>
      </view>
      
      <view class="input-group">
        <text class="input-label">联系电话</text>
        <view class="form-input readonly-field">
          <text>{{formData.respondentPhone}}</text>
        </view>
      </view>
    </view>

    <!-- 投诉事项选择卡片 -->
    <view class="form-card">
      <view class="card-header">
        <text class="card-icon">📋</text>
        <text class="card-title">投诉事项选择</text>
      </view>
      
      <view class="input-group">
        <text class="input-label">请选择适用的投诉事项 <text class="required-mark">*</text></text>
        <text class="section-subtitle">可多选</text>
        
        <text class="input-hint" wx:if="{{selectedItems.length > 0}}">
          ✅ 已选择 {{selectedItems.length}} 项投诉事项
        </text>
        
        <view class="complaint-options">
          <view class="complaint-item {{selectedItems.indexOf('item1') > -1 ? 'selected' : ''}}" 
                bindtap="handleComplaintItemSelect" 
                data-item="item1">
            <view class="custom-checkbox {{selectedItems.indexOf('item1') > -1 ? 'checked' : ''}}">
              <text class="check-icon" wx:if="{{selectedItems.indexOf('item1') > -1}}">✓</text>
            </view>
            <text class="complaint-label">制定的内部劳动保障规章违反劳动法律法规</text>
          </view>
          
          <view class="complaint-item {{selectedItems.indexOf('item2') > -1 ? 'selected' : ''}}" 
                bindtap="handleComplaintItemSelect" 
                data-item="item2">
            <view class="custom-checkbox {{selectedItems.indexOf('item2') > -1 ? 'checked' : ''}}">
              <text class="check-icon" wx:if="{{selectedItems.indexOf('item2') > -1}}">✓</text>
            </view>
            <text class="complaint-label">未依法与投诉人订立书面劳动合同</text>
          </view>
          
          <view class="complaint-item {{selectedItems.indexOf('item3') > -1 ? 'selected' : ''}}" 
                bindtap="handleComplaintItemSelect" 
                data-item="item3">
            <view class="custom-checkbox {{selectedItems.indexOf('item3') > -1 ? 'checked' : ''}}">
              <text class="check-icon" wx:if="{{selectedItems.indexOf('item3') > -1}}">✓</text>
            </view>
            <text class="complaint-label">违法使用童工</text>
          </view>
          
          <view class="complaint-item {{selectedItems.indexOf('item4') > -1 ? 'selected' : ''}}" 
                bindtap="handleComplaintItemSelect" 
                data-item="item4">
            <view class="custom-checkbox {{selectedItems.indexOf('item4') > -1 ? 'checked' : ''}}">
              <text class="check-icon" wx:if="{{selectedItems.indexOf('item4') > -1}}">✓</text>
            </view>
            <text class="complaint-label">违反女职工特殊劳动保护规定</text>
          </view>
          
          <view class="complaint-item {{selectedItems.indexOf('item5') > -1 ? 'selected' : ''}}" 
                bindtap="handleComplaintItemSelect" 
                data-item="item5">
            <view class="custom-checkbox {{selectedItems.indexOf('item5') > -1 ? 'checked' : ''}}">
              <text class="check-icon" wx:if="{{selectedItems.indexOf('item5') > -1}}">✓</text>
            </view>
            <text class="complaint-label">违法延长工作时间，侵害劳动者休息休假权利</text>
          </view>
          
          <view class="complaint-item {{selectedItems.indexOf('item6') > -1 ? 'selected' : ''}}" 
                bindtap="handleComplaintItemSelect" 
                data-item="item6">
            <view class="custom-checkbox {{selectedItems.indexOf('item6') > -1 ? 'checked' : ''}}">
              <text class="check-icon" wx:if="{{selectedItems.indexOf('item6') > -1}}">✓</text>
            </view>
            <text class="complaint-label">拖欠工资且未执行最低工资标准</text>
          </view>
          
          <view class="complaint-item {{selectedItems.indexOf('item7') > -1 ? 'selected' : ''}}" 
                bindtap="handleComplaintItemSelect" 
                data-item="item7">
            <view class="custom-checkbox {{selectedItems.indexOf('item7') > -1 ? 'checked' : ''}}">
              <text class="check-icon" wx:if="{{selectedItems.indexOf('item7') > -1}}">✓</text>
            </view>
            <text class="complaint-label">未依法为投诉人缴纳社会保险费</text>
          </view>
          
          <view class="complaint-item {{selectedItems.indexOf('item8') > -1 ? 'selected' : ''}}" 
                bindtap="handleComplaintItemSelect" 
                data-item="item8">
            <view class="custom-checkbox {{selectedItems.indexOf('item8') > -1 ? 'checked' : ''}}">
              <text class="check-icon" wx:if="{{selectedItems.indexOf('item8') > -1}}">✓</text>
            </view>
            <text class="complaint-label">劳务派遣单位与用工单位违反劳务派遣规定</text>
          </view>
          
          <view class="complaint-item {{selectedItems.indexOf('item9') > -1 ? 'selected' : ''}}" 
                bindtap="handleComplaintItemSelect" 
                data-item="item9">
            <view class="custom-checkbox {{selectedItems.indexOf('item9') > -1 ? 'checked' : ''}}">
              <text class="check-icon" wx:if="{{selectedItems.indexOf('item9') > -1}}">✓</text>
            </view>
            <text class="complaint-label">违反职业介绍规定，收取高额费用且提供虚假岗位信息</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 统一的动态投诉信息填写区域 -->
    <view class="form-card" wx:if="{{selectedItems.length > 0}}">
      <view class="card-header">
        <text class="card-icon">📋</text>
        <text class="card-title">投诉信息填写</text>
      </view>
      
      <!-- 投诉日期 - 必填基础项 -->
      <view class="input-group">
        <text class="input-label">投诉日期 <text class="required-mark">*</text></text>
        <picker class="form-picker" 
                mode="date" 
                value="{{formData.complaintVariables.complaintDate}}" 
                bindchange="handleComplaintDateChange"
                data-variable="complaintDate">
          <text>{{formData.complaintVariables.complaintDate || '请选择投诉日期'}}</text>
        </picker>
      </view>

      <!-- item1相关字段 -->
      <block wx:if="{{selectedItems.indexOf('item1') > -1}}">
        <view class="field-section-header">📋 规章制度违法相关信息</view>
        <view class="input-group">
          <text class="input-label">违法规章制定日期</text>
          <picker class="form-picker" 
                  mode="date" 
                  value="{{formData.complaintVariables.violationDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="violationDate">
            <text>{{formData.complaintVariables.violationDate || '请选择日期'}}</text>
          </picker>
        </view>
      </block>

      <!-- item2相关字段 -->
      <block wx:if="{{selectedItems.indexOf('item2') > -1}}">
        <view class="field-section-header">📝 未签劳动合同相关信息</view>
        <view class="input-group">
          <text class="input-label">入职日期</text>
          <picker class="form-picker" 
                  mode="date" 
                  value="{{formData.complaintVariables.workStartDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="workStartDate">
            <text>{{formData.complaintVariables.workStartDate || '请选择入职日期'}}</text>
          </picker>
        </view>
        <view class="input-group">
          <text class="input-label">工作岗位</text>
          <input class="form-input" 
                 type="text"
                 placeholder="请输入工作岗位" 
                 value="{{formData.complaintVariables.jobPosition}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="jobPosition" />
        </view>
        <view class="input-group">
          <text class="input-label">月工资（元）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入月工资金额" 
                 value="{{formData.complaintVariables.monthlySalary}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="monthlySalary" />
        </view>
        <view class="input-group">
          <text class="input-label">工作截至日期</text>
          <picker class="form-picker" 
                  mode="date" 
                  value="{{formData.complaintVariables.workEndDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="workEndDate">
            <text>{{formData.complaintVariables.workEndDate || '请选择截至日期'}}</text>
          </picker>
        </view>
        <view class="input-group">
          <text class="input-label">工作月数</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入工作月数" 
                 value="{{formData.complaintVariables.workMonths}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="workMonths" />
        </view>
        <view class="input-group">
          <text class="input-label">二倍工资差额（元）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入二倍工资差额" 
                 value="{{formData.complaintVariables.customAmount1}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="customAmount1" />
          <text class="input-hint">💡 提示：可使用"双倍工资计算器"功能计算准确金额</text>
        </view>
      </block>

      <!-- item3相关字段 -->
      <block wx:if="{{selectedItems.indexOf('item3') > -1}}">
        <view class="field-section-header">👶 使用童工相关信息</view>
        <view class="input-group">
          <text class="input-label">童工年龄</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入童工年龄" 
                 value="{{formData.complaintVariables.childAge}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="childAge" />
        </view>
        <view class="input-group">
          <text class="input-label">童工出生日期</text>
          <picker class="form-picker" 
                  mode="date" 
                  value="{{formData.complaintVariables.customDate1}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="customDate1">
            <text>{{formData.complaintVariables.customDate1 || '请选择出生日期'}}</text>
          </picker>
        </view>
      </block>

      <!-- item4相关字段 -->
      <block wx:if="{{selectedItems.indexOf('item4') > -1}}">
        <view class="field-section-header">👩 女职工保护相关信息</view>
        <view class="input-group">
          <text class="input-label">怀孕日期</text>
          <picker class="form-picker" 
                  mode="date" 
                  value="{{formData.complaintVariables.pregnancyDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="pregnancyDate">
            <text>{{formData.complaintVariables.pregnancyDate || '请选择确诊怀孕日期'}}</text>
          </picker>
        </view>
        <view class="input-group">
          <text class="input-label">违法行为发生日期</text>
          <picker class="form-picker" 
                  mode="date" 
                  value="{{formData.complaintVariables.violationDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="violationDate">
            <text>{{formData.complaintVariables.violationDate || '请选择违法日期'}}</text>
          </picker>
        </view>
      </block>

      <!-- item5相关字段 -->
      <block wx:if="{{selectedItems.indexOf('item5') > -1}}">
        <view class="field-section-header">⏰ 违法加班相关信息</view>
        <view class="input-group">
          <text class="input-label">违法加班开始日期</text>
          <picker class="form-picker" 
                  mode="date" 
                  value="{{formData.complaintVariables.workStartDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="workStartDate">
            <text>{{formData.complaintVariables.workStartDate || '请选择开始日期'}}</text>
          </picker>
        </view>
        <view class="input-group">
          <text class="input-label">每日延长工作时间（小时）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入每日加班小时数" 
                 value="{{formData.complaintVariables.overtimeHours}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="overtimeHours" />
        </view>
      </block>

      <!-- item6相关字段 -->
      <block wx:if="{{selectedItems.indexOf('item6') > -1}}">
        <view class="field-section-header">💰 拖欠工资相关信息</view>
        <view class="input-group">
          <text class="input-label">拖欠工资起始月</text>
          <picker class="form-picker" 
                  mode="date" 
                  fields="month"
                  value="{{formData.complaintVariables.workStartDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="workStartDate">
            <text>{{formData.complaintVariables.workStartDate || '请选择起始月'}}</text>
          </picker>
        </view>
        <view class="input-group">
          <text class="input-label">拖欠工资截至月</text>
          <picker class="form-picker" 
                  mode="date" 
                  fields="month"
                  value="{{formData.complaintVariables.workEndDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="workEndDate">
            <text>{{formData.complaintVariables.workEndDate || '请选择截至月'}}</text>
          </picker>
        </view>
        <view class="input-group">
          <text class="input-label">拖欠工资总额（元）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入拖欠工资总额" 
                 value="{{formData.complaintVariables.owedSalary}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="owedSalary" />
        </view>
        <view class="input-group">
          <text class="input-label">月均工资（元）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入月均工资" 
                 value="{{formData.complaintVariables.monthlySalary}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="monthlySalary" />
        </view>
        <view class="input-group">
          <text class="input-label">当地最低工资标准（元）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入最低工资标准" 
                 value="{{formData.complaintVariables.minimumWage}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="minimumWage" />
        </view>
        <view class="input-group">
          <text class="input-label">低于最低工资差额（元）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入差额" 
                 value="{{formData.complaintVariables.customAmount1}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="customAmount1" />
        </view>
      </block>

      <!-- item7相关字段 -->
      <block wx:if="{{selectedItems.indexOf('item7') > -1}}">
        <view class="field-section-header">🛡️ 社保缴纳相关信息</view>
        <view class="input-group">
          <text class="input-label">入职日期</text>
          <picker class="form-picker" 
                  mode="date" 
                  value="{{formData.complaintVariables.workStartDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="workStartDate">
            <text>{{formData.complaintVariables.workStartDate || '请选择入职日期'}}</text>
          </picker>
        </view>
        <view class="input-group">
          <text class="input-label">截止日期</text>
          <picker class="form-picker" 
                  mode="date" 
                  value="{{formData.complaintVariables.workEndDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="workEndDate">
            <text>{{formData.complaintVariables.workEndDate || '请选择截止日期'}}</text>
          </picker>
        </view>
      </block>

      <!-- item8相关字段 -->
      <block wx:if="{{selectedItems.indexOf('item8') > -1}}">
        <view class="field-section-header">🔄 劳务派遣相关信息</view>
        <view class="input-group">
          <text class="input-label">拖欠工资起始月</text>
          <picker class="form-picker" 
                  mode="date" 
                  fields="month"
                  value="{{formData.complaintVariables.workStartDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="workStartDate">
            <text>{{formData.complaintVariables.workStartDate || '请选择起始月'}}</text>
          </picker>
        </view>
        <view class="input-group">
          <text class="input-label">拖欠工资截至月</text>
          <picker class="form-picker" 
                  mode="date" 
                  fields="month"
                  value="{{formData.complaintVariables.workEndDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="workEndDate">
            <text>{{formData.complaintVariables.workEndDate || '请选择截至月'}}</text>
          </picker>
        </view>
        <view class="input-group">
          <text class="input-label">拖欠工资金额（元）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入拖欠工资金额" 
                 value="{{formData.complaintVariables.owedSalary}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="owedSalary" />
        </view>
      </block>

      <!-- item9相关字段 -->
      <block wx:if="{{selectedItems.indexOf('item9') > -1}}">
        <view class="field-section-header">🏢 职业介绍违法相关信息</view>
        <view class="input-group">
          <text class="input-label">求职日期</text>
          <picker class="form-picker" 
                  mode="date" 
                  value="{{formData.complaintVariables.violationDate}}" 
                  bindchange="handleComplaintDateChange"
                  data-variable="violationDate">
            <text>{{formData.complaintVariables.violationDate || '请选择求职日期'}}</text>
          </picker>
        </view>
        <view class="input-group">
          <text class="input-label">服务费（元）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入收取的服务费" 
                 value="{{formData.complaintVariables.serviceFee}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="serviceFee" />
        </view>
        <view class="input-group">
          <text class="input-label">承诺月薪（元）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入承诺的月薪" 
                 value="{{formData.complaintVariables.monthlySalary}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="monthlySalary" />
        </view>
        <view class="input-group">
          <text class="input-label">实际月薪（元）</text>
          <input class="form-input" 
                 type="number"
                 placeholder="请输入实际月薪" 
                 value="{{formData.complaintVariables.customAmount1}}"
                 bindinput="handleComplaintVariableInput"
                 data-variable="customAmount1" />
        </view>
      </block>
    </view>
  </view>

  <!-- 投诉书生成按钮 -->
  <view class="button-section">
    <button class="generate-button" bindtap="handleGenerateDocument">
      📋 生成劳动监察投诉书
    </button>
  </view>

  <!-- 预览区域 -->
  <view class="preview-container" wx:if="{{showPreview && documentContent}}">
    <view class="preview-header">
      <text class="preview-title">📄 文书预览</text>
    </view>
    <view class="document-display">
      <text class="document-text">{{documentContent}}</text>
    </view>
    <view class="action-section">
      <button class="copy-button" bindtap="handleCopyDocument">📋 复制文书</button>
      <button class="share-button" bindtap="handleShareDocument">📤 分享文书</button>
    </view>
  </view>
</view>
